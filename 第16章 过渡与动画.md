# æ¦‚è¿°

@See https://cn.vuejs.org/guide/built-ins/transition.html

@See https://cn.vuejs.org/guide/built-ins/transition-group.html

Vue æä¾›äº†ä¸¤ä¸ªå†…ç½®ç»„ä»¶ï¼Œå¯ä»¥å¸®åŠ©ä½ åˆ¶ä½œåŸºäºçŠ¶æ€å˜åŒ–çš„è¿‡æ¸¡å’ŒåŠ¨ç”»ï¼š

- `<Transition>` ä¼šåœ¨ä¸€ä¸ªå…ƒç´ æˆ–ç»„ä»¶è¿›å…¥å’Œç¦»å¼€ DOM æ—¶åº”ç”¨åŠ¨ç”»ã€‚
- `<TransitionGroup>` ä¼šåœ¨ä¸€ä¸ª `v-for` åˆ—è¡¨ä¸­çš„å…ƒç´ æˆ–ç»„ä»¶è¢«æ’å…¥ï¼Œç§»åŠ¨ï¼Œæˆ–ç§»é™¤æ—¶åº”ç”¨åŠ¨ç”»ã€‚

åœ¨æ­£å¼å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥ç®€å•äº†è§£ä¸€ä¸‹è¿‡æ¸¡ä¸åŠ¨ç”»çš„åŒºåˆ«

é¦–å…ˆï¼Œ**è¿‡æ¸¡ (Transition)** å’Œ **åŠ¨ç”» (Animation)** éƒ½å¯ä»¥è®©å…ƒç´ åŠ¨èµ·æ¥ï¼Œä½†å®ƒä»¬çš„åº”ç”¨åœºæ™¯å’Œå®ç°æ–¹å¼æœ‰æ‰€ä¸åŒã€‚

## è¿‡æ¸¡ (Transition)

**å®šä¹‰**ï¼šå…ƒç´ çš„çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶ï¼Œä»ä¸€ä¸ªçŠ¶æ€å¹³æ»‘è¿‡æ¸¡åˆ°å¦ä¸€ä¸ªçŠ¶æ€çš„è¿‡ç¨‹ã€‚

**ç‰¹ç‚¹**ï¼š

- ä¾èµ–äº‹ä»¶è§¦å‘ï¼Œå¦‚ hoverã€click ç­‰ï¼›
- **ä¸€æ¬¡æ€§** å˜åŒ–ï¼Œåªåœ¨çŠ¶æ€æ”¹å˜æ—¶æ‰§è¡Œï¼›
- åªèƒ½å®šä¹‰ **èµ·å§‹** å’Œ **ç»“æŸ** çŠ¶æ€ï¼Œä¸èƒ½æ§åˆ¶ä¸­é—´çŠ¶æ€ã€‚

**å®ç°æ–¹å¼**ï¼šä½¿ç”¨ CSS çš„ transition å±æ€§ï¼Œä¾‹å¦‚ï¼š

```css
.box {
  transition: background-color 0.5s ease-in-out;
}

.box:hover {
  background-color: blue;
}
```

## åŠ¨ç”» (Animation)

**å®šä¹‰**ï¼šå…ƒç´ åœ¨ä¸€å®šæ—¶é—´å†…æŒç»­å˜æ¢ï¼Œå½¢æˆæµç•…çš„è¿åŠ¨æ•ˆæœã€‚

**ç‰¹ç‚¹**ï¼š

- **ä¸éœ€è¦äº‹ä»¶è§¦å‘**ï¼Œå¯ä»¥è‡ªåŠ¨æ‰§è¡Œï¼›
- å¯ä»¥å¾ªç¯æ’­æ”¾ï¼Œä½¿å…ƒç´ å‘¨æœŸæ€§å˜åŒ–ï¼›
- é€šè¿‡ @keyframes å®šä¹‰å¤šä¸ªä¸­é—´çŠ¶æ€ï¼Œä½¿åŠ¨ç”»æ›´ç»†è…»ã€‚

**å®ç°æ–¹å¼**ï¼šä½¿ç”¨ CSS animation åŠ @keyframesï¼Œä¾‹å¦‚ï¼š

```css
@keyframes fadeIn {
  0% {
    opacity: 0;
  }
  100% {
    opacity: 1;
  }
}

.box {
  animation: fadeIn 1s ease-in-out;
}
```

## è¿‡æ¸¡ vs. åŠ¨ç”»

| **å¯¹æ¯”é¡¹**     | **è¿‡æ¸¡ (Transition)**                     | **åŠ¨ç”» (Animation)**                           |
| -------------- | ----------------------------------------- | ---------------------------------------------- |
| **è§¦å‘æ–¹å¼**   | éœ€è¦äº‹ä»¶è§¦å‘ (`hover`ã€`click` ç­‰)        | å¯è‡ªåŠ¨æ‰§è¡Œï¼Œæ— éœ€äº‹ä»¶è§¦å‘                       |
| **æŒç»­æ€§**     | ä¸€æ¬¡æ€§                                    | å¯å¾ªç¯æ’­æ”¾                                     |
| **æ§åˆ¶ç»†è…»åº¦** | ä»…å®šä¹‰èµ·å§‹/ç»“æŸçŠ¶æ€                       | å¯å®šä¹‰å¤šä¸ªä¸­é—´çŠ¶æ€ï¼Œä½¿åŠ¨ç”»æ›´ç»†è…»               |
| **é€‚ç”¨åœºæ™¯**   | é€‚ç”¨äºç®€å•çš„çŠ¶æ€åˆ‡æ¢ï¼Œå¦‚ `hover`ã€`focus` | é€‚ç”¨äºå¤æ‚çš„è¿ç»­å˜åŒ–ï¼Œå¦‚åŠ è½½åŠ¨ç”»ã€æ—‹è½¬ã€ç¼©æ”¾ç­‰ |

# å¿†å¾€æ˜”

æˆ‘ä»¬å…ˆæ¥ç®€å•å›é¡¾ä¸€ä¸‹åœ¨CSSä¸­å¦‚ä½•å®ç°è¿‡æ¸¡ä¸åŠ¨ç”»æ•ˆæœã€‚

## Transition in CSS

```vue
<script setup lang="ts">
// -- imports
import { ref } from 'vue';

// -- refs
const transition = ref(false);
</script>

<template>
  <div class="box" :class="{ transition }"></div>
  <button type="button" @click="transition = !transition">åˆ‡æ¢è¿‡æ¸¡</button>
</template>

<style scoped>
.box {
  width: 100px;
  height: 100px;
  margin-bottom: 16px;
  background-color: red;
  transition: 0.5s background-color linear;
}
.transition {
  background-color: blue;
}
</style>
```

æ¼”ç¤ºæ•ˆæœï¼š

![](./IMGS/trans_in_css.gif)

## Animation in CSS

```vue
<script setup lang="ts">
// -- imports
import { ref } from 'vue';
// -- refs
const ani = ref(false);
</script>
<template>
  <div class="box" :class="{ ani }"></div>
  <button type="button" @click="ani = !ani">å¯ç”¨åŠ¨ç”»</button>
</template>

<style scoped>
@keyframes ani {
  to {
    transform: translateX(300px);
    background-color: blue;
  }
}
.box {
  width: 100px;
  height: 100px;
  margin-bottom: 16px;
  background-color: red;
}
.ani {
  animation: ani 2s linear 1 forwards;
}
</style>
```

æ¼”ç¤ºæ•ˆæœï¼š

![](./IMGS/ani_in_css.gif)

# \<Transition> ç»„ä»¶

`<Transition>` æ˜¯å†…ç½®çš„ä¸€ä¸ªç»„ä»¶ï¼Œæ— éœ€æ³¨å†Œå³å¯åœ¨ä»»æ„ç»„ä»¶ä¸­ç›´æ¥ä½¿ç”¨ã€‚å®ƒèƒ½å¤Ÿä¸ºé€šè¿‡é»˜è®¤æ’æ§½ä¼ é€’çš„å…ƒç´ æˆ–ç»„ä»¶æ·»åŠ è¿›å…¥å’Œç¦»å¼€åŠ¨ç”»æ•ˆæœã€‚

åŠ¨ç”»çš„è§¦å‘æ¡ä»¶åŒ…æ‹¬ä»¥ä¸‹å‡ ç§ï¼š

- ç”± v-if è§¦å‘çš„æ¡ä»¶æ¸²æŸ“
- ç”± v-show è§¦å‘çš„æ˜¾ç¤ºä¸éšè—
- ç”± \<component> åŠ¨æ€åˆ‡æ¢çš„ç»„ä»¶
- æ”¹å˜ key å±æ€§

> æ³¨æ„ ï¼š \<Transition> ä»…æ”¯æŒå•ä¸ªå…ƒç´ æˆ–ç»„ä»¶ä½œä¸ºæ’æ§½å†…å®¹ã€‚å¦‚æœæ’æ§½å†…å®¹æ˜¯ä¸€ä¸ªç»„ä»¶ï¼Œè¯¥ç»„ä»¶å¿…é¡»å…·æœ‰å”¯ä¸€çš„æ ¹å…ƒç´ ã€‚

å½“ä¸€ä¸ª \<Transition> ç»„ä»¶ä¸­çš„å…ƒç´ è¢«æ’å…¥æˆ–ç§»é™¤æ—¶ï¼ŒVue ä¼šæŒ‰ç…§ä»¥ä¸‹æ­¥éª¤å¤„ç†åŠ¨ç”»ï¼š

1. **CSS è¿‡æ¸¡æˆ–åŠ¨ç”»** ï¼šVue ä¼šè‡ªåŠ¨æ£€æµ‹ç›®æ ‡å…ƒç´ æ˜¯å¦åº”ç”¨äº† CSS è¿‡æ¸¡æˆ–åŠ¨ç”»ã€‚å¦‚æœå­˜åœ¨ï¼ŒVue ä¼šåœ¨é€‚å½“çš„æ—¶æœºæ·»åŠ å’Œç§»é™¤ç›¸å…³çš„ [CSS è¿‡æ¸¡ class](https://cn.vuejs.org/guide/built-ins/transition#transition-classes)
2. **JavaScript é’©å­** ï¼šå¦‚æœå®šä¹‰äº† [JavaScript é’©å­](https://cn.vuejs.org/guide/built-ins/transition.html#javascript-hooks) ï¼ŒVue ä¼šåœ¨åŠ¨ç”»çš„å„ä¸ªé˜¶æ®µè°ƒç”¨è¿™äº›é’©å­å‡½æ•°ã€‚
3. **é»˜è®¤è¡Œä¸º** ï¼šå¦‚æœæ—¢æ²¡æœ‰æ£€æµ‹åˆ° CSS è¿‡æ¸¡æˆ–åŠ¨ç”»ï¼Œä¹Ÿæ²¡æœ‰æä¾› JavaScript é’©å­ï¼ŒVue ä¼šåœ¨æµè§ˆå™¨çš„ä¸‹ä¸€ä¸ªåŠ¨ç”»å¸§ä¸­ç›´æ¥æ‰§è¡Œ DOM çš„æ’å…¥æˆ–åˆ é™¤æ“ä½œã€‚

## åŸºäºCSSçš„è¿‡æ¸¡æ•ˆæœ

### è¿‡æ¸¡ç±»å

Vue ä¸ºè¿›å…¥å’Œç¦»å¼€è¿‡æ¸¡æ•ˆæœæä¾›äº† 6 ä¸ª CSS ç±»ï¼Œç”¨äºå®šä¹‰åŠ¨ç”»çš„ä¸åŒé˜¶æ®µï¼š

![](./IMGS/transition-classes.f0f7b3c9.png)

1. `v-enter-from`ï¼šå®šä¹‰è¿›å…¥åŠ¨ç”»çš„èµ·å§‹çŠ¶æ€ã€‚åœ¨å…ƒç´ æ’å…¥ä¹‹å‰æ·»åŠ ï¼Œåœ¨å…ƒç´ æ’å…¥å®Œæˆåçš„ä¸‹ä¸€å¸§ç§»é™¤ã€‚
2. `v-enter-active`ï¼šå®šä¹‰è¿›å…¥åŠ¨ç”»çš„ç”Ÿæ•ˆçŠ¶æ€ã€‚åº”ç”¨äºæ•´ä¸ªè¿›å…¥åŠ¨ç”»é˜¶æ®µï¼Œåœ¨å…ƒç´ æ’å…¥ä¹‹å‰æ·»åŠ ï¼Œåœ¨è¿‡æ¸¡æˆ–åŠ¨ç”»å®Œæˆåç§»é™¤ã€‚è¯¥ç±»å¯ç”¨äºè®¾ç½®åŠ¨ç”»çš„æŒç»­æ—¶é—´ã€å»¶è¿Ÿä»¥åŠé€Ÿåº¦æ›²çº¿ç±»å‹ã€‚
3. `v-enter-to`ï¼šå®šä¹‰è¿›å…¥åŠ¨ç”»çš„ç»“æŸçŠ¶æ€ã€‚åœ¨å…ƒç´ æ’å…¥å®Œæˆåçš„ä¸‹ä¸€å¸§æ·»åŠ ï¼ˆä¸ v-enter-from çš„ç§»é™¤åŒæ—¶è¿›è¡Œï¼‰ï¼Œå¹¶åœ¨è¿‡æ¸¡æˆ–åŠ¨ç”»å®Œæˆåç§»é™¤ã€‚
4. `v-leave-from`ï¼šå®šä¹‰ç¦»å¼€åŠ¨ç”»çš„èµ·å§‹çŠ¶æ€ã€‚åœ¨ç¦»å¼€è¿‡æ¸¡è§¦å‘æ—¶ç«‹å³æ·»åŠ ï¼Œå¹¶åœ¨ä¸‹ä¸€å¸§ç§»é™¤ã€‚
5. `v-leave-active`ï¼šå®šä¹‰ç¦»å¼€åŠ¨ç”»çš„ç”Ÿæ•ˆçŠ¶æ€ã€‚åº”ç”¨äºæ•´ä¸ªç¦»å¼€åŠ¨ç”»é˜¶æ®µï¼Œåœ¨ç¦»å¼€è¿‡æ¸¡è§¦å‘æ—¶ç«‹å³æ·»åŠ ï¼Œå¹¶åœ¨è¿‡æ¸¡æˆ–åŠ¨ç”»å®Œæˆåç§»é™¤ã€‚è¯¥ç±»å¯ç”¨äºè®¾ç½®åŠ¨ç”»çš„æŒç»­æ—¶é—´ã€å»¶è¿Ÿä»¥åŠé€Ÿåº¦æ›²çº¿ç±»å‹ã€‚
6. `v-leave-to`ï¼šå®šä¹‰ç¦»å¼€åŠ¨ç”»çš„ç»“æŸçŠ¶æ€ã€‚åœ¨ç¦»å¼€åŠ¨ç”»è§¦å‘åçš„ä¸‹ä¸€å¸§æ·»åŠ ï¼ˆä¸ v-leave-from çš„ç§»é™¤åŒæ—¶è¿›è¡Œï¼‰ï¼Œå¹¶åœ¨è¿‡æ¸¡æˆ–åŠ¨ç”»å®Œæˆåç§»

> æ³¨æ„ ï¼šå¦‚æœä¸º \<transition> ç»„ä»¶è®¾ç½®äº† name å±æ€§ï¼Œä¸Šè¿°ç±»åçš„ v- å‰ç¼€å°†æ›¿æ¢ä¸º name å±æ€§å€¼- ã€‚ ä¾‹å¦‚ï¼š \<transition name="fade"> ï¼Œåˆ™ v-enter-from ä¼šæ›¿æ¢ä¸º fade-enter-from ï¼Œå…¶ä»–ç±»åä¾æ­¤ç±»æ¨ã€‚

### CSS è¿‡æ¸¡

CSS è¿‡æ¸¡æ˜¯æœ€å¸¸ç”¨çš„è¿‡æ¸¡ç±»å‹ä¹‹ä¸€ï¼Œä¸¾ä¾‹ï¼š

```vue
<script setup lang="ts">
import { ref } from 'vue';

const visible = ref(true);

</script>

<template>
  <button type="button" @click="visible = !visible">Toggle</button>
  <transition name="slide-fade">
    <div v-show="visible" class="box"></div>
  </transition>
</template>

<style scoped>

.box {
  width: 100px;
  height: 100px;
  margin-top: 16px;
  background-color: red;
}

/*
  è¿›å…¥å’Œç¦»å¼€åŠ¨ç”»å¯ä»¥ä½¿ç”¨ä¸åŒ
  æŒç»­æ—¶é—´å’Œé€Ÿåº¦æ›²çº¿ã€‚
*/
.slide-fade-enter-active {
  transition: all 0.75s ease-out;
}

.slide-fade-leave-active {
  transition: all 1s cubic-bezier(1, 0.5, 0.8, 1);
}

.slide-fade-enter-from,
.slide-fade-leave-to {
  transform: translateX(300px);
  opacity: 0;
}
</style>
```

æ•ˆæœæ¼”ç¤ºï¼š

![](IMGS/transition-01.gif)

ä¸Šè¿°ç¤ºä¾‹ï¼Œç‚¹å‡» `Toggle` æŒ‰é’®ï¼Œåˆ‡æ¢å…ƒç´ æ˜¾ç¤ºçŠ¶æ€ï¼Œä½¿å¾—å…ƒç´ å‘å³ä½ç§» 300 åƒç´ ï¼Œé€æ˜é€æ¸ä¸º0éšè—å…ƒç´ ï¼Œå‘ˆç°å…ƒç´ æ•ˆæœç›¸åã€‚

### CSS åŠ¨ç”»

CSS åŠ¨ç”» CSS åŠ¨ç”»çš„ä½¿ç”¨æ–¹å¼ä¸ CSS è¿‡æ¸¡ç±»ä¼¼ï¼Œä½†æœ‰ä¸€ä¸ªå…³é”®åŒºåˆ«ï¼šåœ¨åŠ¨ç”»ä¸­ï¼Œ v-enter-from ç±»ä¸ä¼šåœ¨å…ƒç´ æ’å…¥ DOM åç«‹å³ç§»é™¤ï¼Œè€Œæ˜¯ä¼šåœ¨ animationend äº‹ä»¶è§¦å‘æ—¶æ‰ç§»é™¤ã€‚

ä»¥ä¸‹æ˜¯ä¸€ä¸ªä½¿ç”¨ CSS åŠ¨ç”»çš„ç¤ºä¾‹ï¼š

```vue
<script setup lang="ts">
import { ref } from 'vue';

const visible = ref(true);

</script>

<template>
  <button type="button" @click="visible = !visible">Toggle</button>
  <transition name="bounce">
    <div v-show="visible" class="box"></div>
  </transition>
</template>

<style scoped>
.box {
  width: 100px;
  height: 100px;
  margin-top: 16px;
  background-color: red;
}
.bounce-enter-active {
  animation: bounce-in 0.5s;
}
.bounce-leave-active {
  animation: bounce-in 0.5s reverse;
}

@keyframes bounce-in {
  0% { transform: scale(0); }
  50% { transform: scale(1.25); }
  100% { transform: scale(1); }
}
</style>
```

> **ä»£ç è§£è¯»**ï¼š
>
> 1. é€šè¿‡ @keyframes å®šä¹‰äº† bounce-in åŠ¨ç”»ï¼Œè¯¥åŠ¨ç”»ä» 0 å¼€å§‹ç¼©æ”¾åˆ° 1.25 å€ï¼Œå†è°ƒæ•´å› 1 å€ï¼Œä»è€Œå®ç°ä¸€ç§ä»æ— åˆ°æœ‰ã€å…ˆæ”¾å¤§å†ç¼©å›åŸå§‹å°ºå¯¸çš„æ•ˆæœã€‚
>2. åœ¨éšè—å…ƒç´ æ—¶ï¼ŒåŒæ ·ä½¿ç”¨äº† bounce-in åŠ¨ç”»ï¼Œä½†æ·»åŠ äº† reverse å…³é”®å­—ã€‚è¯¥å…³é”®å­—çš„ä½œç”¨æ˜¯è®©é¢„å®šä¹‰çš„åŠ¨ç”»åå‘æ‰§è¡Œï¼Œä»è€Œå®ç°ä¸æ˜¾ç¤ºåŠ¨ç”»ç›¸åçš„æ•ˆæœã€‚

æ•ˆæœæ¼”ç¤ºï¼š

![](IMGS/animation-01.gif)

é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå¯ä»¥è½»æ¾å®ç°åŸºäº CSS åŠ¨ç”»çš„è¿‡æ¸¡æ•ˆæœï¼Œå¢å¼ºé¡µé¢çš„åŠ¨æ€äº¤äº’ä½“éªŒã€‚

### è‡ªå®šä¹‰è¿‡æ¸¡ç±»å & animate.css

ä½ ä¹Ÿå¯ä»¥é€šè¿‡å‘ \<Transition> ç»„ä»¶ä¼ é€’ä»¥ä¸‹ props æ¥æŒ‡å®šè‡ªå®šä¹‰çš„è¿‡æ¸¡ç±»åï¼š

- `enter-from-class`
- `enter-active-class`
- `enter-to-class`
- `leave-from-class`
- `leave-active-class`
- `leave-to-class`

è¿™äº›è‡ªå®šä¹‰ç±»åä¼šè¦†ç›–ç›¸åº”é˜¶æ®µçš„é»˜è®¤ç±»åã€‚è¿™ä¸€ç‰¹æ€§åœ¨ä¸ç¬¬ä¸‰æ–¹ CSS åŠ¨ç”»åº“ï¼ˆå¦‚ [Animate.css >>](https://daneden.github.io/animate.css/) ï¼‰é›†æˆæ—¶éå¸¸æœ‰ç”¨ï¼Œå¯ä»¥è®©ä½ åœ¨ Vue çš„åŠ¨ç”»æœºåˆ¶ä¸­æ— ç¼ä½¿ç”¨è¿™äº›åº“æä¾›çš„åŠ¨ç”»æ•ˆæœã€‚

> ğŸ’¡ **ç»“åˆ Ani'ma'te.css ä½¿ç”¨æ¡ˆä¾‹**

**Steps 1ï¼šå®‰è£… animate.css**

```shell
$ pnpm add animate.css
```

**Steps 2ï¼šå¯¼å…¥**

***`main.ts`***

```js
import 'animate.css'
```

**Steps 3ï¼šæ‰“å¼€ [Animate.css >>](https://animate.style/) å®˜ç½‘ï¼Œé€‰æ‹©æ•ˆæœå¹¶å¤åˆ¶æ•ˆæœç±»åï¼ˆclass name)**

![](./IMGS/animate_css_guide.png)

åº”ç”¨ç¤ºä¾‹ï¼š

```html
<h1 class="animate__animated animate__bounce">An animated element</h1>
```

> æç¤ºï¼š`animate__animated` è¿™ä¸ª className **ä¸€å®šè¦** åŠ ä¸Šï¼Œ**ä¸èƒ½çœç•¥**ã€‚

**Steps 4ï¼š ç¼–å†™ä»£ç ï¼Œç²˜è´´æ•ˆæœç±»åï¼ˆclass name)**


```html
<script setup lang="ts">
import { ref } from 'vue';

const visible = ref(true);

</script>

<template>
  <button type="button" @click="visible = !visible">Toggle</button>
  <transition
    enter-active-class="animate__animated animate__bounceIn"
    leave-active-class="animate__animated animate__slideOutRight"
  >
    <h1 class="title" v-show="visible">Animate.css</h1>
  </transition>
</template>
<style scoped>
.title {
  position: absolute;
}
</style>
```

æ•ˆæœæ¼”ç¤ºï¼š

![](IMGS/animation-css.gif)

### åŒæ—¶ä½¿ç”¨è¿‡æ¸¡å’ŒåŠ¨ç”»

åœ¨æŸäº›åœºæ™¯ä¸­ï¼Œä½ å¯èƒ½éœ€è¦åŒæ—¶ä½¿ç”¨ CSS è¿‡æ¸¡ï¼ˆ transition ï¼‰å’Œ CSS åŠ¨ç”»ï¼ˆ animation ï¼‰ã€‚Vue éœ€è¦é€šè¿‡ç›‘å¬ transitionend æˆ– animationend äº‹ä»¶æ¥åˆ¤æ–­åŠ¨ç”»ä½•æ—¶ç»“æŸã€‚å¦‚æœåªä½¿ç”¨äº†å…¶ä¸­ä¸€ç§ï¼ŒVue å¯ä»¥è‡ªåŠ¨æ£€æµ‹åˆ°æ­£ç¡®çš„ç±»å‹ã€‚

ç„¶è€Œï¼Œå¦‚æœåœ¨åŒä¸€ä¸ªå…ƒç´ ä¸ŠåŒæ—¶ä½¿ç”¨äº†è¿‡æ¸¡å’ŒåŠ¨ç”»ï¼ˆä¾‹å¦‚ï¼ŒVue è§¦å‘äº†ä¸€ä¸ª CSS åŠ¨ç”»ï¼Œè€Œé¼ æ ‡æ‚¬åœè§¦å‘äº†å¦ä¸€ä¸ª CSS è¿‡æ¸¡ï¼‰ï¼ŒVue å°†æ— æ³•è‡ªåŠ¨ç¡®å®šåº”è¯¥ç›‘å¬å“ªç§äº‹ä»¶ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ éœ€è¦é€šè¿‡ type prop æ˜¾å¼å£°æ˜ Vue åº”è¯¥å…³æ³¨çš„ç±»å‹ï¼Œå…¶å€¼å¯ä»¥æ˜¯ animation æˆ– transition ã€‚

ç¤ºä¾‹ï¼š

```vue
<template>
  <Transition type="animation">
    <!-- ä½ çš„å†…å®¹ -->
  </Transition>
</template>
```

é€šè¿‡æŒ‡å®š type propï¼Œä½ å¯ä»¥ç¡®ä¿ Vue æ­£ç¡®åœ°å¤„ç†åŠ¨ç”»å’Œè¿‡æ¸¡äº‹ä»¶ï¼Œä»è€Œé¿å…æ½œåœ¨çš„å†²çªæˆ–å¼‚å¸¸è¡Œä¸ºã€‚

### æ·±å±‚çº§è¿‡æ¸¡ä¸æ˜¾å¼è¿‡æ¸¡æ—¶é•¿

å°½ç®¡ \<Transition> ç»„ä»¶çš„è¿‡æ¸¡ç±»ä»…èƒ½ç›´æ¥åº”ç”¨äºå…¶å­å…ƒç´ ï¼Œä½†æˆ‘ä»¬å¯ä»¥é€šè¿‡æ·±å±‚çº§çš„ CSS é€‰æ‹©å™¨ï¼Œä¸ºåµŒå¥—å…ƒç´ æ·»åŠ è¿‡æ¸¡æ•ˆæœã€‚ä¾‹å¦‚ï¼š

```vue
<Transition name="nested">
  <div v-if="show" class="outer">
    <div class="inner">
      Hello
    </div>
  </div>
</Transition>
```

```css
/* ä¸ºåµŒå¥—å…ƒç´ æ·»åŠ è¿‡æ¸¡æ•ˆæœ */
.nested-enter-active .inner,
.nested-leave-active .inner {
  transition: all 0.3s ease-in-out;
}

.nested-enter-from .inner,
.nested-leave-to .inner {
  transform: translateX(30px);
  opacity: 0;
}

/* å…¶ä»–å¿…è¦çš„ CSS è§„åˆ™çœç•¥ */
```

ä¸ºäº†åˆ›å»ºæ›´å¤æ‚çš„åŠ¨ç”»æ•ˆæœï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä¸ºåµŒå¥—å…ƒç´ æ·»åŠ è¿‡æ¸¡å»¶è¿Ÿï¼Œä»è€Œå®ç°äº¤é”™çš„åŠ¨ç”»åºåˆ—ï¼š

```css
/* å»¶è¿ŸåµŒå¥—å…ƒç´ çš„è¿›å…¥ä»¥å®ç°äº¤é”™æ•ˆæœ */
.nested-enter-active .inner {
  transition-delay: 0.25s;
}
```

ç„¶è€Œï¼Œè¿™ç§åµŒå¥—è¿‡æ¸¡ä¼šå¸¦æ¥ä¸€ä¸ªé—®é¢˜ï¼šé»˜è®¤æƒ…å†µä¸‹ï¼Œ \<Transition> ç»„ä»¶ä¼šé€šè¿‡ç›‘å¬æ ¹å…ƒç´ ä¸Šçš„ **ç¬¬ä¸€ä¸ª** transitionend æˆ– animationend äº‹ä»¶æ¥åˆ¤æ–­è¿‡æ¸¡ä½•æ—¶ç»“æŸã€‚åœ¨åµŒå¥—è¿‡æ¸¡ä¸­ï¼Œç†æƒ³çš„è¡Œä¸ºåº”è¯¥æ˜¯ç­‰å¾…æ‰€æœ‰å†…éƒ¨å…ƒç´ çš„è¿‡æ¸¡å®Œæˆã€‚

ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½ å¯ä»¥é€šè¿‡ duration prop æ˜¾å¼æŒ‡å®šè¿‡æ¸¡çš„æ€»æ—¶é•¿ï¼ˆä»¥æ¯«ç§’ä¸ºå•ä½ï¼‰ã€‚æ€»æ—¶é•¿åº”åŒ…å«å»¶è¿Ÿæ—¶é—´ä»¥åŠå†…éƒ¨å…ƒç´ çš„è¿‡æ¸¡æ—¶é—´ï¼š

```vue
<Transition :duration="550">...</Transition>
```

å¦‚æœéœ€è¦ï¼Œä½ è¿˜å¯ä»¥é€šè¿‡å¯¹è±¡å½¢å¼åˆ†åˆ«æŒ‡å®šè¿›å…¥å’Œç¦»å¼€çš„æ—¶é•¿ï¼š

```vue
<Transition :duration="{ enter: 500, leave: 800 }">...</Transition>
```

### æ€§èƒ½è€ƒé‡

åœ¨å®ç°åŠ¨ç”»æ—¶ï¼Œæ€§èƒ½æ˜¯ä¸€ä¸ªé‡è¦çš„è€ƒè™‘å› ç´ ã€‚ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä¸»è¦ä½¿ç”¨äº† transform å’Œ opacity ç­‰å±æ€§æ¥åˆ¶ä½œåŠ¨ç”»ï¼Œè¿™äº›å±æ€§å…·æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼š

1. **ä¸å½±å“ DOM ç»“æ„** ï¼šå®ƒä»¬åœ¨åŠ¨ç”»è¿‡ç¨‹ä¸­ä¸ä¼šè§¦å‘ CSS å¸ƒå±€çš„é‡æ–°è®¡ç®—ï¼Œä»è€Œé¿å…äº†æ˜‚è´µçš„æ€§èƒ½å¼€é”€ã€‚
2. **ç¡¬ä»¶åŠ é€Ÿ** ï¼šç°ä»£æµè§ˆå™¨å¯ä»¥åœ¨æ‰§è¡Œ transform åŠ¨ç”»æ—¶åˆ©ç”¨ GPU è¿›è¡ŒåŠ é€Ÿï¼Œè¿›ä¸€æ­¥æå‡æ€§èƒ½ã€‚

ç›¸æ¯”ä¹‹ä¸‹ï¼Œåƒ height æˆ– margin è¿™æ ·çš„å±æ€§ä¼šè§¦å‘ CSS å¸ƒå±€å˜åŠ¨ï¼Œå¯¼è‡´åŠ¨ç”»æ€§èƒ½è¾ƒå·®ï¼Œå› æ­¤åœ¨ä½¿ç”¨æ—¶éœ€è¦æ ¼å¤–è°¨æ…ã€‚

é€šè¿‡åˆç†é€‰æ‹©åŠ¨ç”»å±æ€§å’Œä¼˜åŒ–è¿‡æ¸¡æ—¶é•¿ï¼Œå¯ä»¥ç¡®ä¿åŠ¨ç”»æ•ˆæœæ—¢æµç•…åˆé«˜æ•ˆã€‚

## JavaScript é’©å­

\<Transition> ç»„ä»¶æä¾›äº†ä¸€ç³»åˆ—äº‹ä»¶é’©å­ï¼Œå…è®¸ä½ åœ¨è¿‡æ¸¡çš„ä¸åŒé˜¶æ®µæ‰§è¡Œè‡ªå®šä¹‰çš„ JavaScript é€»è¾‘ã€‚è¿™äº›é’©å­å¯ä»¥ä¸ CSS è¿‡æ¸¡æˆ–åŠ¨ç”»ç»“åˆä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥å®Œå…¨ç‹¬ç«‹åœ°å®ç°åŠ¨ç”»æ•ˆæœã€‚

### é’©å­å‡½æ•°

ä½ å¯ä»¥é€šè¿‡ç›‘å¬ \<Transition> çš„äº‹ä»¶æ¥æŒ‚è½½é’©å­å‡½æ•°ï¼š

```vue
<Transition
  @before-enter="onBeforeEnter"
  @enter="onEnter"
  @after-enter="onAfterEnter"
  @enter-cancelled="onEnterCancelled"
  @before-leave="onBeforeLeave"
  @leave="onLeave"
  @after-leave="onAfterLeave"
  @leave-cancelled="onLeaveCancelled"
>
  <!-- ä½ çš„å†…å®¹ -->
</Transition>
```
ä»¥ä¸‹æ˜¯æ¯ä¸ªé’©å­å‡½æ•°çš„è¯¦ç»†è¯´æ˜ï¼š
```js
// åœ¨å…ƒç´ æ’å…¥ DOM ä¹‹å‰è°ƒç”¨
// ç”¨äºè®¾ç½®å…ƒç´ çš„ "enter-from" çŠ¶æ€
function onBeforeEnter(el) {}

// åœ¨å…ƒç´ æ’å…¥ DOM åçš„ä¸‹ä¸€å¸§è°ƒç”¨
// ç”¨äºå¯åŠ¨è¿›å…¥åŠ¨ç”»
function onEnter(el, done) {
  // è°ƒç”¨ done() è¡¨ç¤ºè¿‡æ¸¡ç»“æŸ
  // å¦‚æœä¸ CSS ç»“åˆä½¿ç”¨ï¼Œdone æ˜¯å¯é€‰å‚æ•°
  done();
}

// åœ¨è¿›å…¥è¿‡æ¸¡å®Œæˆåè°ƒç”¨
function onAfterEnter(el) {}

// åœ¨è¿›å…¥è¿‡æ¸¡å®Œæˆå‰è¢«å–æ¶ˆæ—¶è°ƒç”¨
function onEnterCancelled(el) {}

// åœ¨ leave é’©å­ä¹‹å‰è°ƒç”¨
// é€šå¸¸ç”¨äºè®¾ç½®ç¦»å¼€å‰çš„åˆå§‹çŠ¶æ€
function onBeforeLeave(el) {}

// åœ¨ç¦»å¼€è¿‡æ¸¡å¼€å§‹æ—¶è°ƒç”¨
// ç”¨äºå¯åŠ¨ç¦»å¼€åŠ¨ç”»
function onLeave(el, done) {
  // è°ƒç”¨ done() è¡¨ç¤ºè¿‡æ¸¡ç»“æŸ
  // å¦‚æœä¸ CSS ç»“åˆä½¿ç”¨ï¼Œdone æ˜¯å¯é€‰å‚æ•°
  done();
}

// åœ¨ç¦»å¼€è¿‡æ¸¡å®Œæˆä¸”å…ƒç´ ä» DOM ä¸­ç§»é™¤åè°ƒç”¨
function onAfterLeave(el) {}

// ä»…åœ¨ v-show è¿‡æ¸¡ä¸­å¯ç”¨
// åœ¨ç¦»å¼€è¿‡æ¸¡å®Œæˆå‰è¢«å–æ¶ˆæ—¶è°ƒç”¨
function onLeaveCancelled(el) {}
```

### çº¯ JavaScript åŠ¨ç”»

å¦‚æœä½ å®Œå…¨ä½¿ç”¨ JavaScript å®ç°åŠ¨ç”»ï¼Œå»ºè®®æ·»åŠ  `:css="false"` propã€‚è¿™ä¼šæ˜¾å¼åœ°å‘Šè¯‰ Vue è·³è¿‡å¯¹ CSS è¿‡æ¸¡çš„è‡ªåŠ¨æ¢æµ‹ï¼Œä»è€Œå¸¦æ¥ä»¥ä¸‹å¥½å¤„ï¼š

1. **æ€§èƒ½ä¼˜åŒ–** ï¼šé¿å…ä¸å¿…è¦çš„ CSS æ¢æµ‹ï¼Œæå‡æ€§èƒ½ã€‚
2. **é¿å…å¹²æ‰°** ï¼šé˜²æ­¢ CSS è§„åˆ™æ„å¤–å½±å“è¿‡æ¸¡æ•ˆæœã€‚

```vue
<Transition
  ...
  :css="false"
>
  <!-- ä½ çš„å†…å®¹ -->
</Transition>
```

å½“ä½¿ç”¨ `:css="false"` æ—¶ï¼Œ @enter å’Œ @leave é’©å­ä¸­çš„ done å›è°ƒå‡½æ•°æ˜¯å¿…é¡»çš„ã€‚å¦åˆ™ï¼Œé’©å­ä¼šåŒæ­¥æ‰§è¡Œï¼Œè¿‡æ¸¡å°†ç«‹å³å®Œæˆã€‚

### ä½¿ç”¨åœºæ™¯

JavaScript é’©å­éå¸¸é€‚åˆä»¥ä¸‹åœºæ™¯ï¼š

1. éœ€è¦ä¸ç¬¬ä¸‰æ–¹åŠ¨ç”»åº“ï¼ˆå¦‚ GSAPã€anime.jsï¼‰é›†æˆã€‚
2. å®ç°å¤æ‚çš„åŠ¨ç”»é€»è¾‘ï¼Œæ— æ³•é€šè¿‡ CSS å•ç‹¬å®Œæˆã€‚
3. åœ¨è¿‡æ¸¡çš„ä¸åŒé˜¶æ®µæ‰§è¡Œé¢å¤–çš„ä¸šåŠ¡é€»è¾‘ã€‚

## å¯å¤ç”¨çš„è¿‡æ¸¡æ•ˆæœ

Vue çš„ç»„ä»¶ç³»ç»Ÿä½¿å¾—è¿‡æ¸¡æ•ˆæœå¯ä»¥è¢«å°è£…å’Œå¤ç”¨ã€‚è¦åˆ›å»ºä¸€ä¸ªå¯å¤ç”¨çš„è¿‡æ¸¡ç»„ä»¶ï¼Œå¯ä»¥åŒ…è£…å†…ç½®çš„ \<Transition> ç»„ä»¶ï¼Œå¹¶é€šè¿‡æ’æ§½ä¼ é€’å†…å®¹ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼š

```vue
<!-- MyTransition.vue -->
<script setup lang="ts">
import { Transition } from 'vue';

// JavaScript é’©å­é€»è¾‘
const onEnter = (el: Element, done: () => void) => {
  // è¿›å…¥åŠ¨ç”»é€»è¾‘
  done();
};

const onLeave = (el: Element, done: () => void) => {
  // ç¦»å¼€åŠ¨ç”»é€»è¾‘
  done();
};
</script>

<template>
  <!-- åŒ…è£…å†…ç½®çš„ Transition ç»„ä»¶ -->
  <Transition
    name="my-transition"
    @enter="onEnter"
    @leave="onLeave"
  >
    <slot></slot> <!-- é€šè¿‡æ’æ§½ä¼ é€’å†…å®¹ -->
  </Transition>
</template>

<style>
/* å®šä¹‰è¿‡æ¸¡æ•ˆæœç›¸å…³çš„ CSS */
.my-transition-enter-active,
.my-transition-leave-active {
  transition: opacity 0.5s ease;
}

.my-transition-enter-from,
.my-transition-leave-to {
  opacity: 0;
}
</style>
```

åœ¨çˆ¶ç»„ä»¶ä¸­ä½¿ç”¨ MyTransition ç»„ä»¶ï¼š

```vue
<template>
  <MyTransition>
    <div v-if="show">Hello</div>
  </MyTransition>
</template>

<script setup lang="ts">
import { ref } from 'vue';
import MyTransition from './MyTransition.vue';

const show = ref(true);
</script>
```

> âš ï¸ **æ³¨æ„äº‹é¡¹**
>
> 1. **é¿å…ä½¿ç”¨ `<style scoped>`** ï¼š
>
>    åœ¨å°è£…è¿‡æ¸¡ç»„ä»¶æ—¶ï¼Œé¿å…åœ¨ \<style> æ ‡ç­¾ä¸­ä½¿ç”¨ scoped å±æ€§ï¼Œå› ä¸º scoped æ ·å¼ä¸ä¼šåº”ç”¨åˆ°æ’æ§½å†…å®¹ä¸Šã€‚
>
> 2. **çµæ´»æ‰©å±•**ï¼š
>
>    ä½ å¯ä»¥åœ¨ MyTransition ç»„ä»¶ä¸­æ·»åŠ æ›´å¤šçš„ props æˆ–é€»è¾‘ï¼Œä»¥é€‚åº”ä¸åŒçš„è¿‡æ¸¡éœ€æ±‚ã€‚ä¾‹å¦‚ï¼Œæ”¯æŒè‡ªå®šä¹‰è¿‡æ¸¡åç§°æˆ–åŠ¨ç”»æ—¶é•¿ã€‚
>
> 3. **å¤ç”¨æ€§**ï¼š
>
>    é€šè¿‡è¿™ç§æ–¹å¼å°è£…çš„è¿‡æ¸¡ç»„ä»¶å¯ä»¥åœ¨é¡¹ç›®çš„ä»»ä½•åœ°æ–¹å¤ç”¨ï¼Œå‡å°‘é‡å¤ä»£ç ï¼Œæå‡å¼€å‘æ•ˆç‡ã€‚

## å‡ºç°æ—¶è¿‡æ¸¡

å¯ä»¥é€šè¿‡ `appear` å±æ€§è®¾ç½®èŠ‚ç‚¹åœ¨ **åˆå§‹æ¸²æŸ“**ï¼ˆå³é¡µé¢åœ¨åˆå§‹åŒ–çš„æ—¶å€™å°±æ‰§è¡Œä¸€æ¬¡åŠ¨ç”»ï¼‰ çš„è¿‡æ¸¡ï¼š

```vue
<transition appear>
  <!-- ... -->
</transition>
```

## å…ƒç´ é—´è¿‡æ¸¡

é™¤äº†é€šè¿‡ `v-if` / `v-show` åˆ‡æ¢ä¸€ä¸ªå…ƒç´ ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡ `v-if` / `v-else` / `v-else-if` åœ¨å‡ ä¸ªç»„ä»¶é—´è¿›è¡Œåˆ‡æ¢ï¼Œåªè¦ç¡®ä¿ä»»ä¸€æ—¶åˆ»åªä¼šæœ‰ä¸€ä¸ªå…ƒç´ è¢«æ¸²æŸ“å³å¯ï¼š

```vue
<Transition>
  <button v-if="docState === 'saved'">Edit</button>
  <button v-else-if="docState === 'edited'">Save</button>
  <button v-else-if="docState === 'editing'">Cancel</button>
</Transition>
```

## è¿‡æ¸¡æ¨¡å¼

`<transition>` çš„é»˜è®¤è¡Œä¸º - è¿›å…¥å’Œç¦»å¼€åŒæ—¶å‘ç”Ÿï¼Œå³ **ä¸Šä¸€ä¸ªç»„ä»¶è¿˜åœ¨æ¶ˆå¤±çš„è¿‡ç¨‹ä¸­ï¼Œä½†ä¸‹ä¸€ä¸ªç»„ä»¶å·²ç»åœ¨å‡ºç°è¿‡ç¨‹ä¸­**ã€‚

ç¤ºä¾‹ï¼š

```vue
<script setup lang="ts">
import { ref } from 'vue';

// -- å®šä¹‰ buttonState å½¢çŠ¶ï¼ˆTSè¯­æ³•ï¼‰
type ButtonStateType = 'disable' | 'enable';
// -- å®šä¹‰ buttonState å˜é‡ï¼Œå…¶ç±»å‹ä¸º ButtonStateType
const buttonState = ref<ButtonStateType>('disable');

</script>

<template>
  <transition>
    <button type="button" v-if="buttonState === 'enable'" @click="buttonState = 'disable'">ç¦ç”¨</button>
    <button type="button" v-else @click="buttonState = 'enable'">å¯ç”¨</button>
  </transition>
</template>

<style scoped>

@keyframes move-in {
  from {
    transform: translateX(100px);
    opacity: 0;
  }
  to {
    transform: translateX(0);
    opacity: 1;
  }
}

button {
  /* ä¸ºäº†æ–¹ä¾¿æŸ¥çœ‹æ•ˆæœï¼Œä½¿ç”¨ç»å¯¹å®šä½ä½¿å…¶é‡å åœ¨ä¸€èµ· */
  position: absolute;
}
.v-enter-active {
  animation: move-in 1s linear;
}
.v-leave-active {
  animation: move-in 1s linear reverse;
}
</style>
```

æ•ˆæœï¼š

![](./IMGS/trans_mode.gif)

å¯ä»¥çœ‹åˆ°ï¼Œåœ¨å¤šç»„ä»¶åˆ‡æ¢æ—¶ï¼Œè¿›å…¥å’Œç¦»å¼€æ˜¯åŒæ—¶å‘ç”Ÿçš„ã€‚åŒæ—¶ç”Ÿæ•ˆçš„è¿›å…¥å’Œç¦»å¼€çš„è¿‡æ¸¡ä¸èƒ½æ»¡è¶³æ‰€æœ‰è¦æ±‚ï¼Œæ‰€ä»¥ Vue æä¾›äº† **è¿‡æ¸¡æ¨¡å¼**

- `in-out`ï¼šæ–°å…ƒç´ å…ˆè¿›è¡Œè¿›å…¥è¿‡æ¸¡ï¼Œå®Œæˆä¹‹åå½“å‰å…ƒç´ è¿‡æ¸¡ç¦»å¼€ã€‚

- `out-in`ï¼šå½“å‰å…ƒç´ å…ˆè¿›è¡Œç¦»å¼€è¿‡æ¸¡ï¼Œå®Œæˆä¹‹åæ–°å…ƒç´ è¿‡æ¸¡è¿›å…¥ã€‚

è¯­æ³•å½¢å¼å¦‚ä¸‹ï¼š

```vue
<transition mode="in-out">
  <!-- ... the buttons ... -->
</transition>
```

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åˆ‡æ¢ä¸¤ç§æ¨¡å¼æŸ¥çœ‹æ•ˆæœï¼š

> **`in-out`**

![](./IMGS/trans_mode_in_out.gif)

> **`out-in`**

![](./IMGS/trans_mode_out_in.gif)

ä¸éš¾å‘ç°ï¼Œ`in-out` å’Œ `out-in` æ¨¡å¼åˆšå¥½ç›¸åã€‚

## ç»„ä»¶é—´è¿‡æ¸¡

`<Transition>` ä¹Ÿå¯ä»¥ä½œç”¨äº[åŠ¨æ€ç»„ä»¶](https://cn.vuejs.org/guide/essentials/component-basics.html#dynamic-components)ä¹‹é—´çš„åˆ‡æ¢ï¼š

```vue
<Transition name="fade" mode="out-in">
  <component :is="activeComponent"></component>
</Transition>
```

> [æŸ¥çœ‹ç¤ºä¾‹æ•ˆæœ >>> ](https://play.vuejs.org/#eNqtVD1v2zAQ/SsHLmmBWArQdlEVA3aRoR3aIs3IhZbODlOKJERKtWH4v/eOUmwldYMM0UTevXvvvqi9WHif9R2KQpSharWPEDB2fi6tbrxrI+wh3Ctj3J9bXMMB1q1r4IIiLo6IL67xi9GR5enGlE8ByyeA5QiQNs+hCzjViA5U73QNFQGdRRthhdpuoEb0ZgduFbDtsZa2cjZEUFXUPTLrAL6ekL1L2byXtsyH6qguukRsvFER+RZLo1Zo6Aj0ldr6LkLcebyWolW1dlJAP2tcjYYsz8TIV/TKdAxOUlLMYcFUZX6ifUuFJSss/1G4a5UNOmpnwaqGwWtVIwUzLd1cF2faUuyYxKm3hQ7nVOdlfsQMEvlJgwxlPm2iLUPcGT5mrDujIGxnA+nlo9Gg6nE0wp4545GxAOdVpeMOrrJPAVAF/CztgamnjLxDz/hoXRLXGF/A1RBIE08picthMo9bPkmbiqp1P7bktEDj/AbXpM6RKe3u65jGOZ1jioG2d6032UNwlthSDVJwz7XB9ofnrgQpiqE69qWl/pZsse24r4O9usfq9xn7Q9iyTYqfLaYnI8XRF1W7QRozu29+fcctnY9O2pnOEPoF5y0GZzrOcYAtO1tT2hNcyvZr+gHQ470LN9uINOyxKE6UkYeEl4Jaym37X+mndD9kH1MczVgc/gIxxp1C)

## åŠ¨æ€è¿‡æ¸¡

\<Transition> ç»„ä»¶çš„ propsï¼ˆä¾‹å¦‚ name ï¼‰å¯ä»¥æ˜¯åŠ¨æ€çš„ï¼Œè¿™ä½¿å¾—æˆ‘ä»¬å¯ä»¥æ ¹æ®ç»„ä»¶çš„çŠ¶æ€åŠ¨æ€åº”ç”¨ä¸åŒçš„è¿‡æ¸¡æ•ˆæœã€‚ä¾‹å¦‚ï¼š

```vue
<Transition :name="transitionName"> 
  <!-- ä½ çš„å†…å®¹ --> 
</Transition>
```

é€šè¿‡åŠ¨æ€ç»‘å®š name ï¼Œå¯ä»¥æå‰å®šä¹‰å¤šç»„ CSS è¿‡æ¸¡æˆ–åŠ¨ç”»ç±»ï¼Œç„¶ååœ¨å®ƒä»¬ä¹‹é—´çµæ´»åˆ‡æ¢ã€‚

> ğŸ“– **åŠ¨æ€è¿‡æ¸¡çš„ä¼˜åŠ¿**

1. **çµæ´»åˆ‡æ¢è¿‡æ¸¡æ•ˆæœ **ï¼š

   å¯ä»¥æ ¹æ®ä¸åŒçš„çŠ¶æ€æˆ–ç”¨æˆ·äº¤äº’åŠ¨æ€åˆ‡æ¢è¿‡æ¸¡ç±»åï¼Œå®ç°å¤šæ ·åŒ–çš„åŠ¨ç”»æ•ˆæœã€‚

2. **JavaScript é’©å­ä¸­çš„åŠ¨æ€è¡Œä¸º**ï¼š

   åœ¨ JavaScript è¿‡æ¸¡é’©å­ä¸­ï¼Œå¯ä»¥æ ¹æ®ç»„ä»¶çš„å½“å‰çŠ¶æ€åº”ç”¨ä¸åŒçš„åŠ¨ç”»é€»è¾‘ï¼Œè¿›ä¸€æ­¥æå‡è¿‡æ¸¡çš„çµæ´»æ€§ã€‚

3. **å¯å¤ç”¨çš„è¿‡æ¸¡ç»„ä»¶**ï¼š

   ç»“åˆåŠ¨æ€ propsï¼Œå¯ä»¥åˆ›å»ºé«˜åº¦å¯å¤ç”¨çš„è¿‡æ¸¡ç»„ä»¶ï¼Œè¿™äº›ç»„ä»¶èƒ½å¤Ÿæ ¹æ®ä¼ å…¥çš„ props åŠ¨æ€è°ƒæ•´è¿‡æ¸¡æ•ˆæœã€‚è¿™æ˜¯å®ç°å¤æ‚åŠ¨æ€è¿‡æ¸¡çš„ç»ˆææ–¹å¼ã€‚

> ğŸ“– **ç¤ºä¾‹**

ä»¥ä¸‹æ˜¯ä¸€ä¸ªåŠ¨æ€åˆ‡æ¢è¿‡æ¸¡ç±»åçš„ç¤ºä¾‹ï¼š

```vue
<template>
  <div>
    <button @click="toggleTransition">åˆ‡æ¢è¿‡æ¸¡æ•ˆæœ</button>
    <Transition :name="transitionName">
      <div v-if="show" class="box"></div>
    </Transition>
  </div>
</template>

<script setup lang="ts">
import { ref } from 'vue';

const show = ref(true);
const transitionName = ref('fade');

const toggleTransition = () => {
  transitionName.value = transitionName.value === 'fade' ? 'slide' : 'fade';
  show.value = !show.value;
};
</script>

<style>
/* å®šä¹‰ä¸¤ç»„è¿‡æ¸¡æ•ˆæœ */
.fade-enter-active,
.fade-leave-active {
  transition: opacity 0.5s;
}
.fade-enter-from,
.fade-leave-to {
  opacity: 0;
}

.slide-enter-active,
.slide-leave-active {
  transition: transform 0.5s;
}
.slide-enter-from {
  transform: translateX(-100%);
}
.slide-leave-to {
  transform: translateX(100%);
}

.box {
  width: 100px;
  height: 100px;
  background-color: red;
  margin-top: 16px;
}
</style>
```

> ğŸ“– **ç»“åˆå¯å¤ç”¨ç»„ä»¶**

```vue
<!-- DynamicTransition.vue -->
<script setup lang="ts">
import { Transition } from 'vue';

defineProps<{
  name: string;
}>();
</script>

<template>
  <Transition :name="name">
    <slot></slot>
  </Transition>
</template>
```

åœ¨çˆ¶ç»„ä»¶ä¸­ä½¿ç”¨ï¼š

 ```vue
 <template>
   <div>
     <button @click="toggleTransition">åˆ‡æ¢è¿‡æ¸¡æ•ˆæœ</button>
     <DynamicTransition :name="transitionName">
       <div v-if="show" class="box"></div>
     </DynamicTransition>
   </div>
 </template>
 
 <script setup lang="ts">
 import { ref } from 'vue';
 import DynamicTransition from './DynamicTransition.vue';
 
 const show = ref(true);
 const transitionName = ref('fade');
 
 const toggleTransition = () => {
   transitionName.value = transitionName.value === 'fade' ? 'slide' : 'fade';
   show.value = !show.value;
 };
 </script>
 ```

## ä½¿ç”¨ Key Attribute è¿‡æ¸¡

ä½¿ç”¨ Key Attribute å®ç°è¿‡æ¸¡ åœ¨æŸäº›åœºæ™¯ä¸­ï¼Œä¸ºäº†è§¦å‘è¿‡æ¸¡æ•ˆæœï¼Œä½ éœ€è¦å¼ºåˆ¶é‡æ–°æ¸²æŸ“ DOM å…ƒç´ ã€‚Vue çš„ key attribute å¯ä»¥å¸®åŠ©ä½ å®ç°è¿™ä¸€ç‚¹ã€‚é€šè¿‡ä¸ºå…ƒç´ ç»‘å®šä¸€ä¸ªåŠ¨æ€çš„ key ï¼ŒVue ä¼šåœ¨ key å€¼å˜åŒ–æ—¶é”€æ¯å¹¶é‡æ–°åˆ›å»ºè¯¥å…ƒç´ ï¼Œä»è€Œè§¦å‘è¿‡æ¸¡æ•ˆæœã€‚

ä»¥ä¸‹æ˜¯ä¸€ä¸ªè®¡æ•°å™¨ç»„ä»¶çš„ç¤ºä¾‹ï¼š

```vue
<script setup lang="ts">
import { ref } from 'vue';

// å®šä¹‰è®¡æ•°å™¨
const count = ref(0);

// æ¯ç§’é€’å¢è®¡æ•°å™¨
setInterval(() => count.value++, 1000);
</script>

<template>
  <Transition>
    <span :key="count">{{ count }}</span>
  </Transition>
</template>
```

> ğŸ“– **ä»£ç è§£æ**

1. `key` çš„ä½œç”¨ï¼š

   å¦‚æœä¸ä½¿ç”¨ key ï¼ŒVue åªä¼šæ›´æ–° \<span> å…ƒç´ çš„æ–‡æœ¬å†…å®¹ï¼Œè€Œä¸ä¼šè§¦å‘è¿‡æ¸¡æ•ˆæœã€‚é€šè¿‡ç»‘å®š key ï¼ŒVue ä¼šåœ¨ count å˜åŒ–æ—¶é”€æ¯æ—§çš„ \<span> å…ƒç´ å¹¶åˆ›å»ºä¸€ä¸ªæ–°çš„å…ƒç´ ï¼Œä»è€Œè§¦å‘ \<Transition> ç»„ä»¶çš„è¿›å…¥å’Œç¦»å¼€è¿‡æ¸¡ã€‚

2. è¿‡æ¸¡æ•ˆæœï¼š

   ç”±äº key çš„å˜åŒ–ï¼Œ \<Transition> ç»„ä»¶ä¼šä¸ºæ—§çš„ \<span> å…ƒç´ åº”ç”¨ç¦»å¼€è¿‡æ¸¡ï¼ŒåŒæ—¶ä¸ºæ–°çš„ \<span> å…ƒç´ åº”ç”¨è¿›å…¥è¿‡æ¸¡ã€‚

> ğŸ“– **ä¸ºä»€ä¹ˆéœ€è¦ `key`**

1. **å¼ºåˆ¶é‡æ–°æ¸²æŸ“ **ï¼škey çš„å˜åŒ–ä¼šå¼ºåˆ¶ Vue é‡æ–°æ¸²æŸ“å…ƒç´ ï¼Œç¡®ä¿è¿‡æ¸¡æ•ˆæœè¢«è§¦å‘ã€‚
2. **åŒºåˆ†å…ƒç´ **ï¼šå½“å¤šä¸ªç›¸åŒç±»å‹çš„å…ƒç´ éœ€è¦è¿‡æ¸¡æ—¶ï¼Œ key å¯ä»¥å¸®åŠ© Vue åŒºåˆ†å®ƒä»¬ï¼Œé¿å…è¿‡æ¸¡é€»è¾‘æ··ä¹±ã€‚

> ğŸ“– **åº”ç”¨åœºæ™¯**

`key` å¸¸ç”¨äºä»¥ä¸‹åœºæ™¯ï¼š

1. **è®¡æ•°å™¨æˆ–æ•°å­—å˜åŒ–** ï¼šå¦‚ä¸Šé¢çš„ç¤ºä¾‹ã€‚
2. **åˆ—è¡¨é¡¹çš„é‡æ’åº** ï¼šä¸ºæ¯ä¸ªåˆ—è¡¨é¡¹ç»‘å®šå”¯ä¸€çš„ key ï¼Œåœ¨åˆ—è¡¨é¡ºåºå˜åŒ–æ—¶è§¦å‘è¿‡æ¸¡ã€‚
3. **åŠ¨æ€ç»„ä»¶åˆ‡æ¢** ï¼šé€šè¿‡ key å¼ºåˆ¶é‡æ–°æ¸²æŸ“åŠ¨æ€ç»„ä»¶ã€‚

# \<TransitionGroup> ç»„ä»¶

`<TransitionGroup>` æ˜¯ä¸€ä¸ªå†…ç½®ç»„ä»¶ï¼Œä¸“é—¨ç”¨äºä¸º v-for åˆ—è¡¨ä¸­çš„å…ƒç´ æˆ–ç»„ä»¶çš„æ’å…¥ã€ç§»é™¤ä»¥åŠé¡ºåºå˜åŒ–æ·»åŠ åŠ¨ç”»æ•ˆæœã€‚å®ƒå’Œ `\<Transition>` ç»„ä»¶éå¸¸ç›¸ä¼¼ï¼Œä½†æœ‰ä¸€äº›å…³é”®åŒºåˆ«ã€‚

## å’Œ \<Transition> çš„åŒºåˆ«

1. **å®¹å™¨å…ƒç´ **ï¼šé»˜è®¤æƒ…å†µä¸‹ï¼Œ \<TransitionGroup> ä¸ä¼šæ¸²æŸ“ä¸€ä¸ªåŒ…è£¹å®¹å™¨å…ƒç´ ã€‚ä½†ä½ å¯ä»¥é€šè¿‡ tag prop æŒ‡å®šä¸€ä¸ªå…ƒç´ ä½œä¸ºå®¹å™¨ã€‚ä¾‹å¦‚ï¼š

   ```vue
   <TransitionGroup tag="ul">
     <!-- åˆ—è¡¨å†…å®¹ -->
   </TransitionGroup>
   ```

2. **è¿‡æ¸¡æ¨¡å¼**ï¼š\<TransitionGroup> ä¸æ”¯æŒè¿‡æ¸¡æ¨¡å¼ï¼ˆå¦‚ `in-out` æˆ– `out-in` ï¼‰ï¼Œå› ä¸ºå®ƒå¤„ç†çš„æ˜¯åˆ—è¡¨ä¸­çš„å¤šä¸ªå…ƒç´ ï¼Œè€Œä¸æ˜¯å•ä¸ªå…ƒç´ ä¹‹é—´çš„åˆ‡æ¢ã€‚

3. **`key` å±æ€§**ï¼šåˆ—è¡¨ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½å¿…é¡»æœ‰ä¸€ä¸ªå”¯ä¸€çš„ key å±æ€§ï¼Œä»¥ä¾¿ Vue èƒ½å¤Ÿæ­£ç¡®è¯†åˆ«å’Œç®¡ç†å…ƒç´ çš„è¿‡æ¸¡ã€‚

4. **CSS è¿‡æ¸¡ç±»**ï¼šCSS è¿‡æ¸¡ç±»ä¼šè¢«åº”ç”¨åˆ°åˆ—è¡¨å†…çš„å…ƒç´ ä¸Šï¼Œè€Œä¸æ˜¯å®¹å™¨å…ƒç´ ä¸Šã€‚

## è¿›å…¥/ç¦»å¼€åŠ¨ç”»

ç°åœ¨è®©æˆ‘ä»¬ç”±ä¸€ä¸ªç®€å•çš„ä¾‹å­æ·±å…¥ï¼Œè¿›å…¥å’Œç¦»å¼€çš„è¿‡æ¸¡ä½¿ç”¨ä¹‹å‰ä¸€æ ·çš„ CSS ç±»åã€‚

```vue
<script setup lang="ts">
import { reactive } from 'vue';

const state = reactive({
  list: [1, 2, 3, 4, 5, 6],
  nextNum: 7,
});

// methods
const randomIndex = () => Math.floor(Math.random() * state.list.length);
// events
const onInsert = () => {
  state.list.splice(randomIndex(), 0, ++state.nextNum);
};
const onRemove = () => {
  state.list.splice(randomIndex(), 1);
};
</script>

<template>
  <!-- æŒ‰é’® -->
  <button type="button" @click="onInsert">INSERT</button>
  <button type="button" @click="onRemove">REMOVE</button>
  <!-- åˆ—è¡¨æ¸²æŸ“ -->
  <transition-group name="list" tag="div" class="list">
    <div class="item" v-for="item in state.list" :key="item">
      {{ item }}
    </div>
  </transition-group>
</template>

<style scoped>
button {
  margin-right: 10px;
  margin-bottom: 16px;
  cursor: pointer;
}
.item {
  display: inline-block;
  margin-right: 10px;
}

.list-enter-active,
.list-leave-active {
  transition: all 1s ease;
}
.list-enter-from,
.list-leave-to {
  opacity: 0;
  transform: translateY(30px);
}
</style>
```

ç¤ºä¾‹æ•ˆæœï¼š

![](IMGS/trans_list_1.gif)

è¿™ä¸ªä¾‹å­æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå½“æ·»åŠ å’Œç§»é™¤å…ƒç´ çš„æ—¶å€™ï¼Œå‘¨å›´çš„å…ƒç´ ä¼š **ç¬é—´ç§»åŠ¨** åˆ°å®ƒä»¬çš„æ–°å¸ƒå±€çš„ä½ç½®ï¼Œè€Œä¸æ˜¯å¹³æ»‘çš„è¿‡æ¸¡ï¼Œæˆ‘ä»¬ä¸‹é¢ä¼šè§£å†³è¿™ä¸ªé—®é¢˜ã€‚

## ç§»åŠ¨åŠ¨ç”»

ä¸ºäº†è§£å†³ä¸Šè¿°ç¤ºä¾‹åœ¨æ·»åŠ å…ƒç´ æ—¶ç¬é—´ç§»åŠ¨çš„é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨æ–°å¢çš„ **`v-move`** ç±»ï¼Œå®ƒä¼šåº”ç”¨åœ¨å…ƒç´ æ”¹å˜å®šä½çš„è¿‡ç¨‹ä¸­ã€‚åƒä¹‹å‰çš„ç±»åä¸€æ ·ï¼Œå®ƒçš„å‰ç¼€å¯ä»¥é€šè¿‡ `name` å±æ€§æ¥è‡ªå®šä¹‰ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ `move-class` å±æ€§æ‰‹åŠ¨è®¾ç½®ã€‚

`v-move` å¯¹äºè®¾ç½®è¿‡æ¸¡çš„åˆ‡æ¢æ—¶æœºå’Œè¿‡æ¸¡æ›²çº¿éå¸¸æœ‰ç”¨ï¼Œç»§ç»­ä¸Šè¿°çš„ä¾‹å­ï¼Œæˆ‘ä»¬é€šè¿‡ [Lodash >>](https://www.lodashjs.com/)  æ‰“ä¹±é›†åˆé¡ºåºã€‚

é¦–å…ˆå®‰è£… loadashï¼š

```shell
$ pnpm add lodash
$ pnpm add @types/lodash -D 
```

ä¿®æ”¹ç¤ºä¾‹ä»£ç ï¼š

```vue
<script setup lang="ts">
// +++
import _ from 'lodash';
// +++

import { reactive } from 'vue';

const state = reactive({
  list: [1, 2, 3, 4, 5, 6],
  nextNum: 7
});

// methods
const randomIndex = () => Math.floor(Math.random() * state.list.length);
// events
// +++
const onShuffle = () => {
  // æ‰“ä¹±é›†åˆé¡ºåº
  state.list = _.shuffle(state.list);
};
// +++
const onInsert = () => {
  state.list.splice(randomIndex(), 0, ++state.nextNum);
};
const onRemove = () => {
  state.list.splice(randomIndex(), 1);
};
</script>

<template>
  <!-- +++ -->
  <button type="button" @click="onShuffle">SHUFFLE</button>
  <!-- +++ -->
  <button type="button" @click="onInsert">INSERT</button>
  <button type="button" @click="onRemove">REMOVE</button>
  <transition-group name="list" tag="div" class="list">
    <div class="item" v-for="item in state.list" :key="item">
      {{ item }}
    </div>
  </transition-group>
</template>

<style scoped>
button {
  margin-right: 10px;
  margin-bottom: 16px;
  cursor: pointer;
}
.item {
  display: inline-block;
  margin-right: 10px;
}

/* +++ */
.list-move {
  transition: transform 1s;
}
/* +++ */

.list-enter-active,
.list-leave-active {
  transition: all 1s ease;
}
.list-enter-from,
.list-leave-to {
  opacity: 0;
  transform: translateY(30px);
}
</style>
```

> æç¤ºï¼šä»£ç ä¸­çš„ `+++` è¡¨ç¤ºæ–°å¢ä»£ç ã€‚

æ¼”ç¤ºæ•ˆæœï¼š

![](IMGS/list-move.gif)

è¿™ä¸ªçœ‹èµ·æ¥å¾ˆç¥å¥‡ï¼Œå…¶å® Vue å†…éƒ¨ä½¿ç”¨äº†ä¸€ä¸ªå« [FLIP](https://aerotwist.com/blog/flip-your-animations/) çš„åŠ¨ç”»æŠ€æœ¯ï¼Œå®ƒä½¿ç”¨ transform å°†å…ƒç´ ä»ä¹‹å‰çš„ä½ç½®å¹³æ»‘è¿‡æ¸¡åˆ°æ–°çš„ä½ç½®ã€‚

> æç¤ºï¼šéœ€è¦æ³¨æ„çš„æ˜¯ä½¿ç”¨ FLIP è¿‡æ¸¡çš„å…ƒç´ ä¸èƒ½è®¾ç½®ä¸º `display: inline`ã€‚ä½œä¸ºæ›¿ä»£æ–¹æ¡ˆï¼Œå¯ä»¥è®¾ç½®ä¸º `display: inline-block` æˆ–è€…å°†å…ƒç´ æ”¾ç½®äº flex å¸ƒå±€ä¸­ã€‚

## åˆ—è¡¨çš„äº¤é”™è¿‡æ¸¡

é€šè¿‡ data å±æ€§ä¸ JavaScript é€šä¿¡ï¼Œå°±å¯ä»¥å®ç°åˆ—è¡¨çš„äº¤é”™è¿‡æ¸¡ï¼š

```vue
<script setup lang="ts">
import { reactive } from 'vue';
import gsap from 'gsap';

interface StateProps {
  list: number[] | null;
}
const state = reactive<StateProps>({
  list: null,
});

// -- æ¨¡æ‹Ÿè¯·æ±‚æ•°æ®
setTimeout(() => {
  state.list = [1, 2, 3, 4, 5];
}, 1000);

const beforeEnter = (el: Element) => {
  const dom = el as HTMLDivElement;
  dom.style.cssText = 'opacity: 0; transform: translateY(30px)';
};
const enter = (el: Element, done: () => void) => {
  const dom = el as HTMLDivElement;
  const dataset = dom.dataset;
  const index = dataset.index || ''; /** è·å–data-indexï¼Œç”¨äºè®¾ç½®å»¶è¿Ÿä»¥è¾¾åˆ°åˆ—è¡¨äº¤é”™æ•ˆæœ */
  gsap.to(dom, {
    duration: 1,
    opacity: 1,
    translateY: 0,
    delay: +index * 0.25,
    onComplete: done,
  });
};
</script>

<template>
  <transition-group
    tag="div"
    :css="false"
    @before-enter="beforeEnter"
    @enter="enter"
  >
    <div
      class="item"
      v-for="(item, index) in state.list"
      :key="item"
      :data-index="index"
    >
      <div class="avatar"></div>
      <div class="info">
        <div class="title"></div>
        <div class="desc"></div>
      </div>
    </div>
  </transition-group>
</template>

<style scoped>
.item {
  width: 90%;
  padding: 10px;
  border-radius: 6px;
  box-shadow: 0 0 10px 1px #eeeeee;
  margin: 0 auto 16px;
  display: flex;
  align-items: center;
}
.avatar {
  width: 60px;
  height: 60px;
  background: #6bb6fc;
  border-radius: 12px;
  margin-right: 16px;
}
.title {
  width: 160px;
  height: 20px;
  border-radius: 20px;
  background: #6bb6fc;
  margin-bottom: 10px;
}
.desc {
  width: 80px;
  height: 20px;
  border-radius: 20px;
  background: #9ed0f8;
}
</style>
```

æ¼”ç¤ºæ•ˆæœï¼š

![](./IMGS/list-stagger.gif)



# çŠ¶æ€è¿‡æ¸¡

Vue çš„è¿‡æ¸¡ç³»ç»Ÿä¸ä»…å¯ä»¥å¤„ç†å…ƒç´ çš„è¿›å…¥ã€ç¦»å¼€å’Œåˆ—è¡¨åŠ¨ç”»ï¼Œè¿˜èƒ½ä¸ºæ•°æ®å…ƒç´ æœ¬èº«çš„å˜åŒ–æ·»åŠ åŠ¨ç”»æ•ˆæœã€‚ä¾‹å¦‚ï¼š

- æ•°å­—å’Œè¿ç®—
- é¢œè‰²çš„æ˜¾ç¤º
- SVG èŠ‚ç‚¹çš„ä½ç½®
- å…ƒç´ çš„å¤§å°å’Œå…¶ä»–çš„å±æ€§

è¿™äº›æ•°æ®é€šå¸¸ä»¥æ•°å€¼å½¢å¼å­˜å‚¨ï¼Œæˆ–è€…å¯ä»¥è½¬æ¢ä¸ºæ•°å€¼ã€‚é€šè¿‡ç»“åˆ Vue çš„å“åº”æ€§å’Œç»„ä»¶ç³»ç»Ÿï¼Œå¹¶å€ŸåŠ©ç¬¬ä¸‰æ–¹åº“ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾å®ç°è¿™äº›çŠ¶æ€çš„è¿‡æ¸¡æ•ˆæœã€‚

## ä½¿ç”¨ GSAP å®ç°æ•°å­—æ»šåŠ¨åŠ¨ç”»

GSAPï¼ˆGreenSock Animation Platformï¼‰æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„ JavaScript åŠ¨ç”»åº“ï¼Œéå¸¸é€‚åˆç”¨äºå®ç°å¤æ‚çš„åŠ¨ç”»æ•ˆæœã€‚

- [è‹±æ–‡å®˜ç½‘ >>](https://greensock.com/)

- [ä¸­æ–‡ç½‘åœ°å€ >>](https://www.tweenmax.com.cn/index.html)

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬é€šè¿‡ GSAP ç»“åˆ Vue å®ç°æ•°å­—æ»šåŠ¨çš„æ•ˆæœã€‚

é¦–å…ˆï¼Œå®‰è£… gsapï¼š

```shell
$ pnpm add gsap
```

ç„¶åç›´æ¥ä¸Šç¤ºä¾‹ä»£ç ï¼š

```vue
<script setup lang="ts">
import { reactive } from 'vue';
import gsap from 'gsap';

// å®šä¹‰å“åº”å¼çŠ¶æ€
const state = reactive({
  count: 100,
});

// å¢åŠ æ•°å­—çš„å‡½æ•°
const onPlus = () => {
  gsap.to(state, {
    duration: 0.75, // åŠ¨ç”»æŒç»­æ—¶é—´
    count: state.count + Math.random() * 100, // éšæœºå¢åŠ æ•°å€¼
    ease: 'sine', // åŠ¨ç”»é€Ÿåº¦æ›²çº¿
  });
};
</script>

<template>
  <button type="button" style="cursor: pointer" @click="onPlus">å¢åŠ æ•°é¢</button>
  <p>&yen;&nbsp;{{ state.count.toFixed(2) }}</p>
</template>
```

æ¼”ç¤ºæ•ˆæœï¼š

![](IMGS/trans_gsap.gif)

# Examples

## ğŸ‘‰ ä½ç§»åŠ¨ç”»@v-move-active

åˆ—è¡¨çš„è¿›å…¥ & ç¦»å¼€è¿‡æ¸¡ï¼Œå¯¹åˆ—è¡¨ç›´æ¥æ“ä½œï¼ˆå¢ã€åˆ ï¼‰çš„å…ƒç´ ï¼Œå°è£… **\<transition-group>** å¹¶æŒ‰å¸¸è§„çš„ CSS æˆ– JS è¿‡æ¸¡å³å¯ï¼›ä½†åœ¨æ“ä½œè¿™äº›å…ƒç´ çš„ä½ç½®å˜åŒ–æ—¶ï¼Œç”±äºDOMæ–‡æ¡£æµçš„å˜åŒ–ï¼Œä¼šåŒæ—¶å¼•èµ·å…¶å®ƒï¼ˆé‚»è¿‘ï¼‰èŠ‚ç‚¹å…ƒç´ çš„ä½ç½®å˜åŒ–ï¼Œä¾‹å¦‚åœ¨åˆ—è¡¨æ’å…¥ä¸€ä¸ª\<li>ï¼Œæ’å…¥ç‚¹åŸæœ¬çš„\<li>ä¼šä¸‹ç§»ï¼Œåˆ é™¤ä¸€ä¸ª\<li>ï¼Œä¸‹é¢çš„\<li>ä¼šä¸Šç§»è¡¥å……å æ®è¿™ä¸ªä½ç½®ã€‚ 

å¯¹äºè¿™äº› â€œè¢«åŠ¨â€ ç§»åŠ¨çš„å…ƒç´ æ¥è¯´ï¼Œä¹Ÿå¯ä»¥å®ç°è¿‡æ¸¡ï¼Œè¿™å°±ç”¨åˆ°äº† `v-move` ç‰¹æ€§ï¼Œå…¶ä¸­ `v` å’Œè¿‡æ¸¡å±æ€§ç±»ä¼¼ï¼Œä¾èµ–äº `name` å±æ€§çš„è®¾å®šï¼Œå‡è®¾è®¾ç½® **\<transition-group name="list">**ï¼Œåˆ™è®¾ç½®è¿‡æ¸¡å±æ€§çš„ç±»åä¸ºï¼š`.list-move`ã€‚

å®ç°æ•ˆæœï¼š

![](./IMGs/transition_v_move.gif)

å®ç°ä»£ç ï¼š

```vue

<script setup lang="ts">
import { reactive } from 'vue';

interface StateProps {
  list: Array<number>;
  next: number;
}
// -- state
const state = reactive<StateProps>({
  list: [1, 2, 3, 4],
  next: 4,
});

// -- methods
const randomIndex = () => Math.floor(Math.random() * state.list.length);

// -- events
const onInsert = () => {
  state.list.splice(randomIndex(), 0, ++state.next);
};
const onRemove = () => {
  state.list.splice(randomIndex(), 1);
};
</script>

<template>
  <div class="page">
    <transition-group class="list" tag="ul" name="list">
      <!-- key å€¼ä¸èƒ½ä½¿ç”¨ä¸‹æ ‡indexï¼Œå¦åˆ™åŠ¨ç”»æ— æ•ˆ -->
      <div v-for="item in state.list" :key="item" class="item">
        {{ item }}
      </div>
    </transition-group>
    <div class="actions">
      <button @click="onInsert">INSERT</button>
      <button @click="onRemove">REMOVE</button>
    </div>
  </div>
</template>

<style lang="less">
.page {
  display: flex;
  flex-direction: column;
  align-items: center;
}

.list-enter-from {
  opacity: (0);
  transform: translateY(-50px);
}
.list-enter-to {
  opacity: (1);
  transform: translateY(0);
}
.list-leave-from {
  opacity: (1);
}
.list-leave-to {
  opacity: (0);
}
.list-move,
.list-enter-active,
.list-leave-active {
  transition: all 0.5s ease;
}
// -- Tipsï¼šè¦è®©åˆ é™¤çš„å…ƒç´ è„±ç¦»æ–‡æ¡£æµï¼Œåé¢çš„å…ƒç´ æ‰ä¼šè¿‡æ¸¡è¿‡æ¥
.list-leave-active {
  position: absolute;
}

.list {
  margin: 50px auto;
  white-space: nowrap;
  .item {
    display: inline-block;
    width: 120px;
    line-height: 160px;
    text-align: center;
    background: linear-gradient(to bottom, #000 10%, red);
    font-size: 36px;
    color: #ffffff;
    font-family: 'Times New Roman', Times, serif;
    &:not(:last-child) {
      margin-right: 2px;
    }
  }
}

.actions {
  button {
    cursor: pointer;
    &:not(:last-child) {
      margin-right: 10px;
    }
  }
}
</style>

```

## ğŸ‘‰ æ— é™æ»šåŠ¨

åœ¨å®é™…å¼€å‘ä¸­ï¼Œé¦–é¡µå¯èƒ½ä¼šå¾ªç¯æ’­æ”¾ä¸€äº›å‡æ•°æ®ä»¥å®ç°å®æ—¶æ’­æŠ¥çš„åŠŸèƒ½ï¼Œå¦‚å¦‚ä¸‹æ•ˆæœï¼š

![](./IMGs/transition_circle_move.gif)

å®ç°ä»£ç ï¼š

```vue
<script setup lang="ts">
import { onMounted, onBeforeUnmount, reactive, nextTick } from 'vue';


interface StateProps {
  colors: Array<{ label: string; color: string }>;
  timer: any;
}
  
// -- state
const state = reactive<StateProps>({
  colors: [
    { label: 'A', color: '#4b69ff' },
    { label: 'B', color: '#e4ae39' },
    { label: 'C', color: '#8847ff' },
    { label: 'D', color: '#d32ce6' },
    { label: 'E', color: '#eb4b4b' },
  ],
  timer: null,
});

// -- life circles
onMounted(() => {
  state.timer = setInterval(() => {
    const color = state.colors.pop();
    if (color) {
      nextTick(() => {
        state.colors.unshift(color);
      });
    }
  }, 2000);
});
onBeforeUnmount(() => {
  clearInterval(state.timer);
});

// -- methods
const getBgColor = (colorStop: string) => {
  return `linear-gradient(to bottom, #000 10%, ${colorStop} 100%)`;
};
</script>

<template>
  <div class="page">
    <transition-group class="list" tag="ul" name="list">
      <!-- key å€¼ä¸èƒ½ä½¿ç”¨ä¸‹æ ‡indexï¼Œå¦åˆ™åŠ¨ç”»æ— æ•ˆ -->
      <div
        v-for="item in state.colors"
        :key="item.label"
        class="item"
        :style="{ background: getBgColor(item.color) }"
      >
        {{ item.label }}
      </div>
    </transition-group>
  </div>
</template>

<style lang="less">
  
.list-enter-from,
.list-leave-to {
  opacity: 0;
  transform: translateY(-30px);
}
.list-enter-to,
.list-leave-from {
  opacity: 1;
  transform: translateY(0);
}
.list-move,
.list-enter-active,
.list-leave-active {
  transition: all 1.5s ease;
}
  
.list {
  width: calc(120px * 4);
  margin: 50px auto;
  white-space: nowrap;
  overflow-x: hidden;
  .item {
    display: inline-block;
    width: 120px;
    line-height: 160px;
    text-align: center;
    background-color: red;
    font-size: 36px;
    color: #ffffff;
    font-family: 'Times New Roman', Times, serif;
  }
}
</style>
```



